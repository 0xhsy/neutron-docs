<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-relaying/icq-relayer-guide">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-rc.1">
<title data-rh="true">Interchain Queries Relayer Guide | Neutron Docs</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://neutron-org.github.io/neutron-docs/relaying/icq-relayer-guide"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Interchain Queries Relayer Guide | Neutron Docs"><meta data-rh="true" name="description" content="Overview"><meta data-rh="true" property="og:description" content="Overview"><link data-rh="true" rel="icon" href="/neutron-docs/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://neutron-org.github.io/neutron-docs/relaying/icq-relayer-guide"><link data-rh="true" rel="alternate" href="https://neutron-org.github.io/neutron-docs/relaying/icq-relayer-guide" hreflang="en"><link data-rh="true" rel="alternate" href="https://neutron-org.github.io/neutron-docs/relaying/icq-relayer-guide" hreflang="x-default"><link rel="stylesheet" href="/neutron-docs/assets/css/styles.a3c8eceb.css">
<link rel="preload" href="/neutron-docs/assets/js/runtime~main.d967c5fe.js" as="script">
<link rel="preload" href="/neutron-docs/assets/js/main.e77b37e2.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/neutron-docs/"><div class="navbar__logo"><img src="/neutron-docs/img/logo.jpeg" alt="Neutron Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/neutron-docs/img/logo.jpeg" alt="Neutron Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Neutron</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/neutron-docs/">Introduction</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/neutron-org" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><div class="navbar__search searchBarContainer_NW3z"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/neutron-docs/">Neutron</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/neutron-docs/neutron-core/build">Neutron Core</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/neutron-docs/relaying/ibc-relayer-guide">Relaying</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/neutron-docs/relaying/ibc-relayer-guide">IBC Relayer Guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/neutron-docs/relaying/icq-relayer-guide">Interchain Queries Relayer Guide</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/neutron-docs/tutorials/cosmwasm_ica">Tutorials</a></div></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/neutron-docs/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Relaying</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Interchain Queries Relayer Guide</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Interchain Queries Relayer Guide</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="overview">Overview<a class="hash-link" href="#overview" title="Direct link to heading">â€‹</a></h2><p><a href="/neutron-docs/neutron-core/interchain-queries/overview">Interchain Queries</a> allow smart contracts to make queries to a remote chain. An ICQ Relayer is a required component for making them possible. It acts as a facilitator between the Neutron chain and a querying chain, gathering queries that are needed to be performed from the Neutron, actually performing them, and eventually making the results available for the Neutron&#x27;s smart contracts. These three main responsibilities are described in details below.</p><p>If you are a smart contracts developer and up to develop your dApp on Neutron, you will most likely need your own ICQ Relayer to manage your Interchain Queries. </p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="queries-gathering">Queries gathering<a class="hash-link" href="#queries-gathering" title="Direct link to heading">â€‹</a></h3><p>All registered Interchain Queries and their parameters are stored in the eponymous module and available by its <a href="/neutron-docs/neutron-core/interchain-queries/client#queries">query interface</a>. The Relayer utilises the module&#x27;s interface in order to initialise the performing list of queries. This is how the Relayer maintains the list of queries to be executed:</p><ul><li>on initialisation, the ICQ module <code>RegisteredQueries</code> query is executed with the <code>RELAYER_REGISTRY_ADDRESSES</code> parameter used for the <code>Owners</code> field;</li><li>during the rest of the run, the Relayer listens to the ICQ module&#x27;s <code>query_update</code> and <code>query_removed</code> <a href="/neutron-docs/neutron-core/interchain-queries/events">events</a> and modifies the queries list and parameters correspondingly.</li></ul><p>The Relayer also listens to the Neutron&#x27;s <code>NewBlockHeader</code> events that are used as a trigger for queries execution. Since each query has its own <code>update_period</code>, the Relayer tracks queries execution height and executes only the queries which update time has come.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="queries-execution">Queries execution<a class="hash-link" href="#queries-execution" title="Direct link to heading">â€‹</a></h3><p>When the update time comes for a query, the Relayer runs the specified query on the remote chain:</p><ul><li>in case of a KV-query, the Relayer just <a href="https://github.com/neutron-org/cosmos-query-relayer/blob/4542045ab24d2735890e70d4dc525677d5f30c8a/internal/proof/proof_impl/get_storage_values.go#L11" target="_blank" rel="noopener noreferrer">reads</a>
necessary KV-keys from the remote chain&#x27;s storage with <a href="https://github.com/cosmos/cosmos-sdk/blob/ae77f0080a724b159233bd9b289b2e91c0de21b5/docs/interfaces/lite/specification.md" target="_blank" rel="noopener noreferrer">Merkle Proofs</a>. Neutron will need these proofs to <a href="https://github.com/neutron-org/neutron/blob/49c33ff43122cb12ee20e98493e0e2439a94f928/x/interchainqueries/keeper/msg_server.go#L217" target="_blank" rel="noopener noreferrer">verify</a> validity of KV-results on results submission;</li><li>in case of a TX-query, the Relayer makes a query to the target chain&#x27;s <a href="https://docs.tendermint.com/v0.33/app-dev/indexing-transactions.html#querying-transactions" target="_blank" rel="noopener noreferrer">Tendermint RPC</a>
to search transactions by message types, events and attributes which were emitted during transactions execution and were
<a href="https://docs.tendermint.com/v0.33/app-dev/indexing-transactions.html" target="_blank" rel="noopener noreferrer">indexed</a> by Tendermint. More about Tx query parameters syntax <a href="/neutron-docs/neutron-core/interchain-queries/messages#register-interchain-query">in the dedicated section</a>. When Relayer submits transactions search results to Neutron chain, it <strong>DOES NOT</strong> include events into result (even if events were used for the query), because <a href="https://github.com/tendermint/tendermint/blob/bff63aec83a4cfbb3bba253cfa04737fb21dacb4/types/results.go#L47" target="_blank" rel="noopener noreferrer">events are not deterministic</a>, therefore they can break blockchain consensus.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="results-submission">Results submission<a class="hash-link" href="#results-submission" title="Direct link to heading">â€‹</a></h3><p>Relayer submits a query result as the following depending on the Relayer&#x27;s configuration:</p><ul><li>simply sending it to the Neutron&#x27;s Interchain Queries module which handles it by storing the result in the blockchain state (KV queries with <code>RELAYER_ALLOW_KV_CALLBACKS</code>=false);</li><li>sending it to the Neutron&#x27;s Interchain Queries module which handles it by storing the result in the blockchain state and passing the result to the owner smart contract (KV queries with <code>RELAYER_ALLOW_KV_CALLBACKS</code>=true);</li><li>passing it to the smart contract that has registered the query (TX queries).</li></ul><p>This means that it&#x27;s the Relayer who pays gas for these actions. Note that KV queries submission are straightforward and therefore cheap whereas TX ones and KV callbacks also include smart contract call and their cost may vary significantly.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="a-bit-of-technical-details-about-tx-submission">A bit of technical details about TX submission<a class="hash-link" href="#a-bit-of-technical-details-about-tx-submission" title="Direct link to heading">â€‹</a></h4><p>The KV queries are submitted in a fire-and-forget way, i.e. they are submitted once per <code>update_period</code> span and never retried forcibly (e.g. on a submission error). The TX queries are a bit more tricky: since they are not stored in the Neutron chain and simply passed to smart contracts, it&#x27;s needed that each tx is passed and handled by the smart contract only once. The Relayer uses the <code>BroadcastTxSync</code> messages broadcast type to maintain balance between performance and submission detalisation, but this means that the submission result is not waited for. To achieve both submission speed and only one submission handling, the Relayer fires submission messages, remembers the query result as sent, and then in the background retrieves the submission result for the query. If it turns to be a success, the TX is saved as fully processed and will not be sent to the smart contract again. Otherwise, this tx will be marked as failed and will not be sent to the smart contract again during this run. Instead, to prevent repeated submission of transactions which can&#x27;t be successfully handled by the smart contract, the retry will only be possible on Relayer restart.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="configuration">Configuration<a class="hash-link" href="#configuration" title="Direct link to heading">â€‹</a></h2><p>This section contains description for all the possible config values that the Relayer supports. For example values see the <a href="https://github.com/neutron-org/neutron-query-relayer/blob/main/.env.example" target="_blank" rel="noopener noreferrer">.env.example</a> file in the Relayer&#x27;s repository.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="neutron-node-settings">Neutron node settings<a class="hash-link" href="#neutron-node-settings" title="Direct link to heading">â€‹</a></h3><ul><li><code>RELAYER_NEUTRON_CHAIN_RPC_ADDR</code> â€” RPC address of a Neutron node to interact with (e.g. get events and to submit results);</li><li><code>RELAYER_NEUTRON_CHAIN_REST_ADDR</code> â€” REST address of a Neutron node to interact with (e.g. get registered queries list);</li><li><code>RELAYER_NEUTRON_CHAIN_CHAIN_ID</code> â€” Neutron chain ID;</li><li><code>RELAYER_NEUTRON_CHAIN_HOME_DIR</code> â€” path to keys directory;</li><li><code>RELAYER_NEUTRON_CHAIN_SIGN_KEY_NAME</code> â€” name of the key pair to be used by the Relayer;</li><li><code>RELAYER_NEUTRON_CHAIN_TIMEOUT</code> â€” timeout for Neutron RPC calls;</li><li><code>RELAYER_NEUTRON_CHAIN_GAS_PRICES</code> â€” the price for a unit of gas used by the Relayer;</li><li><code>RELAYER_NEUTRON_CHAIN_GAS_LIMIT</code> â€” the maximum price to be paid for a single submission;</li><li><code>RELAYER_NEUTRON_CHAIN_GAS_ADJUSTMENT</code> â€” gas multiplier used in order to avoid underestimating;</li><li><code>RELAYER_NEUTRON_CHAIN_CONNECTION_ID</code> â€” Neutron chain connection ID;</li><li><code>RELAYER_NEUTRON_CHAIN_CLIENT_ID</code> â€” IBC client ID for an IBC connection between the Neutron chain and the target chain;</li><li><code>RELAYER_NEUTRON_CHAIN_DEBUG</code> â€” flag to run neutron chain provider in debug mode;</li><li><code>RELAYER_NEUTRON_CHAIN_KEYRING_BACKEND</code> â€” described <a href="https://docs.cosmos.network/master/run-node/keyring.html#the-kwallet-backend" target="_blank" rel="noopener noreferrer">here</a>;</li><li><code>RELAYER_NEUTRON_CHAIN_OUTPUT_FORMAT</code> â€” Neutron chain provider output format;</li><li><code>RELAYER_NEUTRON_CHAIN_SIGN_MODE_STR</code> â€” described <a href="https://docs.cosmos.network/master/core/transactions.html#signing-transactions" target="_blank" rel="noopener noreferrer">here</a>, also consider use short variation, e.g. <code>direct</code>.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="target-chain-node-settings">Target chain node settings<a class="hash-link" href="#target-chain-node-settings" title="Direct link to heading">â€‹</a></h3><ul><li><code>RELAYER_TARGET_CHAIN_RPC_ADDR</code> â€” RPC address of a target chain node to interact with (e.g. send queries);</li><li><code>RELAYER_TARGET_CHAIN_CHAIN_ID</code> â€” target chain ID;</li><li><code>RELAYER_TARGET_CHAIN_ACCOUNT_PREFIX</code> â€” target chain account prefix;</li><li><code>RELAYER_TARGET_CHAIN_VALIDATOR_ACCOUNT_PREFIX</code> â€” target chain validator account prefix;</li><li><code>RELAYER_TARGET_CHAIN_TIMEOUT</code> â€” timeout for target chain RPC calls;</li><li><code>RELAYER_TARGET_CHAIN_CONNECTION_ID</code> â€” target chain connection ID;</li><li><code>RELAYER_TARGET_CHAIN_CLIENT_ID</code> â€” IBC client ID for an IBC connection between the Neutron chain and the target chain;</li><li><code>RELAYER_TARGET_CHAIN_DEBUG</code> â€” flag to run neutron chain provider in debug mode;</li><li><code>RELAYER_TARGET_CHAIN_OUTPUT_FORMAT</code> â€” target chain provider output format.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="relayer-application-settings">Relayer application settings<a class="hash-link" href="#relayer-application-settings" title="Direct link to heading">â€‹</a></h3><ul><li><code>RELAYER_REGISTRY_ADDRESSES</code> â€” a list of comma-separated smart-contract addresses (registered query owners) for which the Relayer processes interchain queries. If empty, literally all registered queries are processed which is usable if you are up to deploy a public Relayer;</li><li><code>RELAYER_ALLOW_TX_QUERIES</code> â€” if true, Relayer will process tx queries (if <code>false</code>, Relayer will ignore them). A true value here is mostly usable for a private Relayer because TX queries submission is quite expensive;</li><li><code>RELAYER_ALLOW_KV_CALLBACKS</code> â€” if <code>true</code>, will pass proofs as sudo callbacks to contracts. A true value here is mostly usable for a private Relayer because KV query callbacks execution is quite expensive. If false, results will simply be submitted to Neutron and become available for smart contracts retrieval;</li><li><code>RELAYER_MIN_KV_UPDATE_PERIOD</code> â€” minimal period of queries execution and submission. This value is usable for a public Relayer as a rate limiter because it roughly overrides the queries <code>update_period</code> and force queries execution not more often than <code>N</code> blocks;</li><li><code>RELAYER_STORAGE_PATH</code> â€” path to leveldb storage, will be created on the given path if it doesn&#x27;t exist. It is required if <code>RELAYER_ALLOW_TX_QUERIES</code> is <code>true</code>;</li><li><code>RELAYER_CHECK_SUBMITTED_TX_STATUS_DELAY</code> â€” delay in seconds between TX query submission and the result handling checking (more about this in the <a href="#a-bit-of-technical-details-about-tx-submission">TX submission section</a>);</li><li><code>RELAYER_QUERIES_TASK_QUEUE_CAPACITY</code> â€” capacity of the channel that is used to send messages from subscriber to Relayer. Better set to a higher value to avoid problems with Tendermint websocket subscriptions.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="prerequisites">Prerequisites<a class="hash-link" href="#prerequisites" title="Direct link to heading">â€‹</a></h2><p>Before running the Relayer application for production purposes, you need to create a wallet for the Relayer, top it up, and set up the configuration (refer to the <a href="#configuration">Configuration</a> section).</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="setting-up-relayer-wallet">Setting up Relayer wallet<a class="hash-link" href="#setting-up-relayer-wallet" title="Direct link to heading">â€‹</a></h3><ol><li>The keyring folder for Relayer&#x27;s usage is configured by the <code>RELAYER_NEUTRON_CHAIN_HOME_DIR</code> variable. The easiest way is to run <code>neutrond keys</code> from the cloned <a href="https://github.com/neutron-org/neutron" target="_blank" rel="noopener noreferrer">neutron repository</a> and get the default value from the <code>--keyring-dir</code> flag:</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">neutrond keys</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Keyring management commands. These keys may be in any format supported by the</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Tendermint crypto library and can be used by light-clients, full nodes, or any other application</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">that needs to sign with a private key.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Flags:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      --keyring-dir string       The client Keyring directory; if omitted, the default &#x27;home&#x27; directory will be used</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Global Flags:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      --home string         directory for config and data (default &quot;/Users/your-user/.neutrond&quot;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="2"><li>Then execute <code>neutrond keys add relayer --keyring-backend test</code> to create an account in the default keyring directory;</li><li>Use <code>relayer</code> as the <code>RELAYER_NEUTRON_CHAIN_SIGN_KEY_NAME</code>, <code>test</code> as the <code>RELAYER_NEUTRON_CHAIN_KEYRING_BACKEND</code>, and pass the keyring directory as a volume to the Relayer&#x27;s docker container using the keyring path in the container as the <code>RELAYER_NEUTRON_CHAIN_HOME_DIR</code>;</li><li>Get the Relayer&#x27;s wallet address and top its balance up. If you&#x27;re running the Relayer on the testnet, use the official Neutron faucet. For the mainnet, get some NTRN for the address.</li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="running-the-relayer">Running the Relayer<a class="hash-link" href="#running-the-relayer" title="Direct link to heading">â€‹</a></h2><ol><li>Make sure you&#x27;ve finished the <a href="#configuration">Configuration</a> part;</li><li>Build Relayer&#x27;s docker image from the Relayer&#x27;s folder:</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">make build-docker</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="3"><li>Run Relayer in a docker container way:</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker run --env-file .env.example -p 9999:9999 neutron-org/neutron-query-relayer</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Notes:</p><ul><li><code>-p 9999:9999</code> exposes the port that allows access to the Relayer&#x27;s metrics;</li><li>add keyring passing to the volumes list. For example, assign <code>RELAYER_NEUTRON_CHAIN_HOME_DIR=/keyring</code> and run the app as:</li></ul><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker run --env-file .env.example -v /Users/your-user/.neutrond:/keyring -p 9999:9999 neutron-org/neutron-query-relayer</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/neutron-docs/relaying/ibc-relayer-guide"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">IBC Relayer Guide</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/neutron-docs/tutorials/cosmwasm_ica"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">CosmWasm + ICA</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview" class="table-of-contents__link toc-highlight">Overview</a><ul><li><a href="#queries-gathering" class="table-of-contents__link toc-highlight">Queries gathering</a></li><li><a href="#queries-execution" class="table-of-contents__link toc-highlight">Queries execution</a></li><li><a href="#results-submission" class="table-of-contents__link toc-highlight">Results submission</a></li></ul></li><li><a href="#configuration" class="table-of-contents__link toc-highlight">Configuration</a><ul><li><a href="#neutron-node-settings" class="table-of-contents__link toc-highlight">Neutron node settings</a></li><li><a href="#target-chain-node-settings" class="table-of-contents__link toc-highlight">Target chain node settings</a></li><li><a href="#relayer-application-settings" class="table-of-contents__link toc-highlight">Relayer application settings</a></li></ul></li><li><a href="#prerequisites" class="table-of-contents__link toc-highlight">Prerequisites</a><ul><li><a href="#setting-up-relayer-wallet" class="table-of-contents__link toc-highlight">Setting up Relayer wallet</a></li></ul></li><li><a href="#running-the-relayer" class="table-of-contents__link toc-highlight">Running the Relayer</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/neutron-docs/">Intro</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/neutron-org/neutron" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2022 Neutron Org. Built with Docusaurus.</div></div></div></footer></div>
<script src="/neutron-docs/assets/js/runtime~main.d967c5fe.js"></script>
<script src="/neutron-docs/assets/js/main.e77b37e2.js"></script>
</body>
</html>